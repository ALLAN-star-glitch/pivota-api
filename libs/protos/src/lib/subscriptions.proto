syntax = "proto3";

package subscriptions;

// ===================================================
// SERVICE DEFINITION
// ===================================================
service SubscriptionService {
  rpc SubscribeToPlan (SubscribeToPlanRequest) returns (BaseSubscriptionResponse);
  rpc GetSubscriptionsByAccount (GetSubscriptionByAccountRequest) returns (BaseSubscriptionsResponse);
}

// ===================================================
// ERROR PAYLOAD
// ===================================================
message ErrorPayload {
  string code = 1;
  string message = 2;
  string details = 3;
}

// ===================================================
// BASE RESPONSES
// ===================================================
message BaseSubscriptionResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  Subscription subscription = 4;
  ErrorPayload error = 5;
}

message BaseSubscriptionsResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  repeated Subscription subscriptions = 4;
  ErrorPayload error = 5;
}

// ===================================================
// ENTITIES
// ===================================================
message Subscription {
  string id = 1;
  string subscriberUuid = 2;         
  string plan = 3;
  string type = 4;
  repeated string entityIds = 5; 
  string status = 6;
  string billingCycle = 7;
  float totalAmount = 8;     
  float amountPaid = 9;
  string currency = 10;
  string startedAt = 11;
  string expiresAt = 12;    
  string createdAt = 13;
  string updatedAt = 14;
}

// ===================================================
// REQUEST MESSAGES
// ===================================================
message SubscribeToPlanRequest {
  string subscriberUuid = 1;           
  string planId = 2;                  // Free, Starter, Professional, Enterprise
  repeated string entityIds = 3;      // array of listing 
  string billingCycle = 4;            // monthly, quarterly, halfYearly, annually
  string status = 5;                  // ACTIVE, PARTIALLY_PAID, CANCELLED, EXPIRED
  float amountPaid = 6;
  string currency = 7;
  float totalAmount = 8;
  string type = 9;                    // PLAN, LISTING_GROUP, MODULE, PAYGO
}

message GetSubscriptionByAccountRequest {
  string accountUuid = 1;             // <-- changed from accountUuid
}

// ===================================================
// EMPTY REQUEST
// ===================================================
message EmptyRequest {}
