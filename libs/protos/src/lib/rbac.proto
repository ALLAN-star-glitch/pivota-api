syntax = "proto3";

package rbac;

service RbacService {
  rpc CreateRole (CreateRoleRequest) returns (BaseRoleResponse);
  rpc UpdateRole (UpdateRoleRequest) returns (BaseRoleResponse);
  rpc CreatePermission (CreatePermissionRequest) returns (BasePermissionResponse);
  rpc AssignPermissionToRole (AssignPermissionToRoleRequest) returns (BasePermissionRoleResponse);
  rpc AssignRoleToUser (AssignRoleToUserRequest) returns (BaseUserRoleResponse);
  rpc GetUserRole (GetUserRolesRequest) returns (BaseGetUserRolesResponse);
  rpc GetRoleIdByType (RoleIdRequest) returns (BaseGetRoleIdByTypeResponse);
}



// ---------------------------
// Requests
// ---------------------------

message RoleIdRequest {
  string roleType = 1;
}

message CreateRoleRequest {
  string name = 1;
  string description = 2;
}

message UpdateRoleRequest {
  int32 id = 1;
  string name = 2;
  string description = 3;
}

message CreatePermissionRequest {
  string action = 1;
  string description = 2;
}

message AssignPermissionToRoleRequest {
  int32 roleId = 1;
  int32 permissionId = 2;
}

//  Updated: use UUID instead of numeric userId
message AssignRoleToUserRequest {
  string userUuid = 1;
  int32 roleId = 2;
}

// Updated: also use UUID for querying user roles
message GetUserRolesRequest {
  string userUuid = 1;
}

// ---------------------------
// Common Error Payload
// ---------------------------

message ErrorPayload {
  string message = 1;
  string code = 2;
  string details = 3;
}

// ---------------------------
// Base Response Wrappers
// ---------------------------

message BaseRoleResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  RoleResponse role = 4;
  ErrorPayload error = 5;
}

message BasePermissionResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  PermissionResponse descriptionAction = 4;
  ErrorPayload error = 5;
}

message BaseUserRoleResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  UserRoleResponse userRole = 4;
  ErrorPayload error = 5;
}

message BasePermissionRoleResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  PermissionRoleResponse permissionRole = 4;
  ErrorPayload error = 5;
}

message BaseGetUserRolesResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  RoleResponse role = 4;
  ErrorPayload error = 5;
}

message BaseGetRoleIdByTypeResponse {
  bool success = 1;
  string code = 2;
  string message = 3;
  RoleIdResponse data = 4;
  ErrorPayload error = 5;
}


// ---------------------------
// Entities
// ---------------------------


message RoleResponse {
  string id = 1;
  string name = 2;
  string roleType = 3;
  string description = 4;
  string createdAt = 5;
  string updatedAt = 6;
}


message PermissionResponse {
  int32 id = 1;
  string action = 2;
  string description = 3;
}

// Updated: userUuid instead of numeric userId
message UserRoleResponse {
  int32 id = 1;
  string userUuid = 2;
  int32 roleId = 3;
}

message PermissionRoleResponse {
  int32 id = 1;
  int32 roleId = 2;
  int32 permissionId = 3;
}


message RoleIdResponse {
  int32 roleId = 1;
}